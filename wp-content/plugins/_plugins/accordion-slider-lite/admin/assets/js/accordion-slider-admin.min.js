(function(a){var l={panels:[],panelCounter:0,postsData:{},allowPanelImageResize:!0,init:function(){"single"===as_js_vars.page?this.initSingleAccordionPage():"all"===as_js_vars.page&&this.initAllAccordionsPage()},initSingleAccordionPage:function(){var c=this;this.initPanels();-1!==parseInt(as_js_vars.id,10)&&this.loadAccordionData();a("form").on("submit",function(a){a.preventDefault();c.saveAccordion()});a(".preview-accordion").on("click",function(a){a.preventDefault();c.previewAccordion()});a(".add-panel").on("click",
function(a){a.preventDefault();c.addImagePanels()});a(".postbox .hndle, .postbox .handlediv").on("click",function(){var b=a(this).parent(".postbox");!0===b.hasClass("closed")?b.removeClass("closed"):b.addClass("closed")});a(".sidebar-settings").on("mouseover","label",function(){c.showInfo(a(this))});a(window).resize(function(){!0===c.allowPanelImageResize&&(c.resizePanelImages(),c.allowPanelImageResize=!1,setTimeout(function(){c.resizePanelImages();c.allowPanelImageResize=!0},250))})},initAllAccordionsPage:function(){var c=
this;a(".accordions-list").on("click",".preview-accordion",function(b){b.preventDefault();c.previewAccordionAll(a(this))});a(".accordions-list").on("click",".delete-accordion",function(b){b.preventDefault();c.deleteAccordion(a(this))});a(".accordions-list").on("click",".duplicate-accordion",function(b){b.preventDefault();c.duplicateAccordion(a(this))});a(".clear-all-cache").on("click",function(b){b.preventDefault();a(".clear-cache-spinner").css({display:"inline-block",visibility:"visible"});b=a(this).attr("data-nonce");
a.ajax({url:as_js_vars.ajaxurl,type:"post",data:{action:"accordion_slider_lite_clear_all_cache",nonce:b},complete:function(b){a(".clear-cache-spinner").css({display:"",visibility:""})}})})},loadAccordionData:function(){var c=this;a(".panel-spinner").css({display:"inline-block",visibility:"visible"});a.ajax({url:as_js_vars.ajaxurl,type:"get",data:{action:"accordion_slider_lite_get_accordion_data",id:as_js_vars.id,nonce:as_js_vars.lad_nonce},complete:function(b){b=a.parseJSON(b.responseText);a.each(b.panels,
function(b,e){var k={background:{},layers:e.layers,html:e.html,settings:a.isArray(e.settings)?{}:e.settings};a.each(e,function(a,b){-1!==a.indexOf("background")&&(k.background[a]=b)});c.getPanel(b).setData("all",k)});a(".panel-spinner").css({display:"",visibility:""})}})},saveAccordion:function(){var c=this.getAccordionData();c.nonce=as_js_vars.sa_nonce;c.action="save";var c=JSON.stringify(c),b=a(".update-spinner").css({display:"inline-block",visibility:"visible"});a.ajax({url:as_js_vars.ajaxurl,
type:"post",data:{action:"accordion_slider_lite_save_accordion",data:c},complete:function(c){b.css({display:"",visibility:""});-1===parseInt(as_js_vars.id,10)&&!1===isNaN(c.responseText)?(a("h2").after('<div class="updated"><p>'+as_js_vars.accordion_create+"</p></div>"),window.location=as_js_vars.admin+"?page=accordion-slider-lite&id="+c.responseText+"&action=edit"):0===a(".updated").length&&a("h2").after('<div class="updated"><p>'+as_js_vars.accordion_update+"</p></div>")}})},getAccordionData:function(){var c=
this,b={id:as_js_vars.id,name:a("input#title").val(),settings:{},panels:[],panels_state:{}};a(".panels-container").find(".panel").each(function(f){var e=a(this),k=c.getPanel(parseInt(e.attr("data-id"),10)).getData("all");k.position=parseInt(e.attr("data-position"),10);b.panels[f]=k});a(".sidebar-settings").find(".setting").each(function(){var c=a(this);b.settings[c.attr("name")]="checkbox"===c.attr("type")?c.is(":checked"):c.val()});a(".sidebar-settings").find(".postbox").each(function(){var c=a(this);
b.panels_state[c.attr("data-name")]=c.hasClass("closed")?"closed":""});return b},previewAccordion:function(){h.open(this.getAccordionData())},previewAccordionAll:function(c){var b=a.lightURLParse(c.attr("href"));c=b.lad_nonce;b=parseInt(b.id,10);a.ajax({url:as_js_vars.ajaxurl,type:"get",data:{action:"accordion_slider_lite_get_accordion_data",id:b,nonce:c},complete:function(b){b=a.parseJSON(b.responseText);h.open(b)}})},deleteAccordion:function(c){var b=a.lightURLParse(c.attr("href")),f=b.da_nonce,
e=parseInt(b.id,10),k=c.parents("tr"),d=a('<div class="modal-overlay"></div><div class="modal-window-container">\t<div class="modal-window delete-accordion-dialog">\t\t<p class="dialog-question">'+as_js_vars.accordion_delete+'</p>\t\t<div class="dialog-buttons">\t\t\t<a class="button dialog-ok" href="#">'+as_js_vars.yes+'</a>\t\t\t<a class="button dialog-cancel" href="#">'+as_js_vars.cancel+"</a>\t\t</div>\t</div></div>").appendTo("body");a(".modal-window-container").css("top",a(window).scrollTop());
d.find(".dialog-ok").one("click",function(b){b.preventDefault();a.ajax({url:as_js_vars.ajaxurl,type:"post",data:{action:"accordion_slider_lite_delete_accordion",id:e,nonce:f},complete:function(a){e===parseInt(a.responseText,10)&&k.fadeOut(300,function(){k.remove()})}});d.remove()});d.find(".dialog-cancel").one("click",function(a){a.preventDefault();d.remove()});d.find(".modal-overlay").one("click",function(a){d.remove()})},duplicateAccordion:function(c){var b=a.lightURLParse(c.attr("href"));c=b.dua_nonce;
b=parseInt(b.id,10);a.ajax({url:as_js_vars.ajaxurl,type:"post",data:{action:"accordion_slider_lite_duplicate_accordion",id:b,nonce:c},complete:function(b){a(b.responseText).appendTo(a(".accordions-list tbody")).hide().fadeIn()}})},initPanels:function(){var c=this;a(".panels-container").find(".panel").each(function(b){c.initPanel(a(this))});a(".panels-container").lightSortable({children:".panel",placeholder:"panel panel-placeholder",sortEnd:function(b){a(".panel").each(function(b){a(this).attr("data-position",
b)})}})},initPanel:function(a,b){var f=this,e=new d(a,this.panelCounter,b);this.panels.push(e);e.on("duplicatePanel",function(a){f.duplicatePanel(a.panelData)});e.on("deletePanel",function(a){f.deletePanel(a.id)});a.attr("data-id",this.panelCounter);a.attr("data-position",this.panelCounter);this.panelCounter++},getPanel:function(c){var b;a.each(this.panels,function(a,e){if(e.id===c)return b=e,!1});return b},duplicatePanel:function(c){var b=this,f=a.extend(!0,{},c);a.ajax({url:as_js_vars.ajaxurl,type:"post",
data:{action:"accordion_slider_lite_add_panels",data:JSON.stringify([{settings:{content_type:f.settings.content_type},background_source:f.background.background_source}])},complete:function(c){c=a(c.responseText).appendTo(a(".panels-container"));b.initPanel(c,f)}})},deletePanel:function(c){var b=this,f=b.getPanel(c),e=a('<div class="modal-overlay"></div><div class="modal-window-container">\t<div class="modal-window delete-panel-dialog">\t\t<p class="dialog-question">'+as_js_vars.panel_delete+'</p>\t\t<div class="dialog-buttons">\t\t\t<a class="button dialog-ok" href="#">'+
as_js_vars.yes+'</a>\t\t\t<a class="button dialog-cancel" href="#">'+as_js_vars.cancel+"</a>\t\t</div>\t</div></div>").appendTo("body");a(".modal-window-container").css("top",a(window).scrollTop());e.find(".dialog-ok").one("click",function(c){c.preventDefault();f.off("duplicatePanel");f.off("deletePanel");f.remove();e.remove();b.panels.splice(a.inArray(f,b.panels),1)});e.find(".dialog-cancel").one("click",function(a){a.preventDefault();e.remove()});e.find(".modal-overlay").one("click",function(a){e.remove()})},
addImagePanels:function(){var c=this;g.open(function(b){var f=[];a.each(b,function(a,b){f.push({background_source:b.url,background_alt:b.alt,background_title:b.title,background_width:b.width,background_height:b.height,background_link:b.link})});a.ajax({url:as_js_vars.ajaxurl,type:"post",data:{action:"accordion_slider_lite_add_panels",data:JSON.stringify(f)},complete:function(b){var d=a(".panels-container").find(".panel").length-1;a(".panels-container").append(b.responseText).find(".panel"+(-1===d?
"":":gt("+d+")")).each(function(b){var d=a(this);c.initPanel(d,{background:f[b],layers:{},html:"",settings:{}})})}})})},showInfo:function(c){var b=c.attr("data-info"),f=null;"undefined"!==typeof b&&(f=a('<div class="info-tooltip">'+b+"</div>").appendTo(c.parent()),f.css({left:-f.outerWidth(!0),marginTop:.5*-f.outerHeight(!0)-9}));c.on("mouseout",function(){null!==f&&f.remove()})},resizePanelImages:function(){var c=a(".panel-preview").width()/a(".panel-preview").height();a(".panel-preview > img").each(function(){var b=
a(this);b.width()/b.height()>c?b.css({width:"auto",height:"100%"}):b.css({width:"100%",height:"auto"})})}},d=function(c,b,f){this.$panel=c;this.id=b;this.data=f;this.events=a({});"undefined"===typeof this.data&&(this.data={background:{},layers:{},html:"",settings:{}});this.init()};d.prototype={init:function(){var a=this;this.$panel.find(".panel-preview").on("click",function(b){g.open(function(b){b=b[0];a.setData("background",{background_source:b.url,background_alt:b.alt,background_title:b.title,background_width:b.width,
background_height:b.height,background_link:b.link});a.updatePanelPreview()})});this.$panel.find(".delete-panel").on("click",function(b){b.preventDefault();a.trigger({type:"deletePanel",id:a.id})});this.$panel.find(".duplicate-panel").on("click",function(b){b.preventDefault();a.trigger({type:"duplicatePanel",panelData:a.data})});this.resizeImage()},getData:function(c){if("all"===c){var b={};a.each(this.data.background,function(a,c){b[a]=c});b.layers=this.data.layers;b.html=this.data.html;b.settings=
this.data.settings;return b}if("background"===c)return this.data.background},setData:function(c,b){var d=this;"all"===c?this.data=b:"background"===c&&a.each(b,function(a,b){d.data.background[a]=b})},remove:function(){this.$panel.find(".panel-preview").off("click");this.$panel.find(".delete-panel").off("click");this.$panel.find(".duplicate-panel").off("click");this.$panel.fadeOut(500,function(){a(this).remove()})},updatePanelPreview:function(){var c=this.$panel.find(".panel-preview"),b=this.data.settings.content_type;
c.empty();if("undefined"===typeof b||"custom"===b)b=this.data.background.background_source,"undefined"!==typeof b&&""!==b?(a('<img src="'+b+'" />').appendTo(c),this.resizeImage()):a('<p class="no-image">'+as_js_vars.no_image+"</p>").appendTo(c),this.$panel.removeClass("dynamic-panel")},resizeImage:function(){var a=this.$panel.find(".panel-preview"),b=this.$panel.find(".panel-preview > img");if(b.length)var d=setInterval(function(){!0===b[0].complete&&(clearInterval(d),b.width()/b.height()>a.width()/
a.height()?b.css({width:"auto",height:"100%"}):b.css({width:"100%",height:"auto"}))},100)},on:function(a,b){this.events.on(a,b)},off:function(a){this.events.off(a)},trigger:function(a){this.events.triggerHandler(a)}};var g={open:function(a){var b=[],d=wp.media.editor.insert;wp.media.editor.send.attachment=function(a,c){var d="undefined"!==typeof c.sizes[a.size]?c.sizes[a.size]:c.sizes.full;b.push({url:d.url,alt:c.alt,title:c.title,width:d.width,height:d.height,link:"custom"===a.link?a.linkUrl:""})};
wp.media.editor.insert=function(e){a.call(this,b);wp.media.editor.insert=d};wp.media.editor.open("media-loader")}},h={previewWindow:null,accordion:null,accordionData:null,open:function(c){this.accordionData=c;var b=this,d=a(".preview-spinner").css({display:"inline-block",visibility:"visible"});a.ajax({url:as_js_vars.ajaxurl,type:"post",data:{action:"accordion_slider_lite_preview_accordion",data:JSON.stringify(c)},complete:function(c){a("body").append(c.responseText);b.init();d.css({display:"",visibility:""})}})},
init:function(){var c=this;a(".modal-window-container").css("top",a(window).scrollTop());this.previewWindow=a(".preview-window .modal-window");this.accordion=this.previewWindow.find(".accordion-slider");this.previewWindow.find(".close-x").on("click",function(a){c.close()});var b=this.accordionData.settings.width,d=this.accordionData.settings.height,e=-1!==b.indexOf("%"),h=-1!==d.indexOf("%");!0===e?this.accordion.accordionSlider("width","100%"):b=parseInt(b,10);!0===h&&this.accordion.accordionSlider("height",
"100%");a(window).on("resize.accordionSlider",function(){!0===e?c.previewWindow.css("width",a(window).width()*(parseInt(b,10)/100)-100):b>=a(window).width()-100?c.previewWindow.css("width",a(window).width()-100):c.previewWindow.css("width",b);!0===h&&c.previewWindow.css("height",a(window).height()*(parseInt(d,10)/100)-200)});a(window).trigger("resize");a(window).trigger("resize")},close:function(){this.previewWindow.find(".close-x").off("click");a(window).off("resize.accordionSlider");this.accordion.accordionSlider("destroy");
a("body").find(".modal-overlay, .modal-window-container").remove()}};a(document).ready(function(){l.init()})})(jQuery);
(function(a){var l=function(d,g){this.options=g;this.$container=a(d);this.$placeholder=this.$selectedChild=null;this.initialMouseY=this.initialMouseX=this.panelInitialY=this.panelInitialX=this.currentMouseY=this.currentMouseX=0;this.isDragging=!1;this.checkHover=0;this.uid=(new Date).valueOf();this.events=a({});this.endPosition=this.startPosition=0;this.init()};l.prototype={init:function(){this.settings=a.extend({},this.defaults,this.options);this.$container.on("mousedown.lightSortable"+this.uid,
a.proxy(this._onDragStart,this));a(document).on("mousemove.lightSortable."+this.uid,a.proxy(this._onDragging,this));a(document).on("mouseup.lightSortable."+this.uid,a.proxy(this._onDragEnd,this))},_onDragStart:function(d){1!==d.which||a(d.target).is("select")||a(d.target).is("input")||(this.$selectedChild=a(d.target).is(this.settings.children)?a(d.target):a(d.target).parents(this.settings.children),1===this.$selectedChild.length&&(this.initialMouseX=d.pageX,this.initialMouseY=d.pageY,this.panelInitialX=
this.$selectedChild.position().left,this.panelInitialY=this.$selectedChild.position().top,this.startPosition=this.$selectedChild.index(),d.preventDefault()))},_onDragging:function(d){if(null!==this.$selectedChild&&0!==this.$selectedChild.length){d.preventDefault();this.currentMouseX=d.pageX;this.currentMouseY=d.pageY;if(!this.isDragging){this.isDragging=!0;this.trigger({type:"sortStart"});a.isFunction(this.settings.sortStart)&&this.settings.sortStart.call(this,{type:"sortStart"});d=this.$container.is("ul")||
this.$container.is("ol")?"li":"div";this.$placeholder=a("<"+d+">").addClass("ls-ignore "+this.settings.placeholder).insertAfter(this.$selectedChild);0===this.$placeholder.width()&&this.$placeholder.css("width",this.$selectedChild.outerWidth());0===this.$placeholder.height()&&this.$placeholder.css("height",this.$selectedChild.outerHeight());this.$selectedChild.css({"pointer-events":"none",position:"absolute",left:this.$selectedChild.position().left,top:this.$selectedChild.position().top,width:this.$selectedChild.width(),
height:this.$selectedChild.height()}).addClass("ls-ignore");this.$container.append(this.$selectedChild);a("body").css("user-select","none");var g=this;this.checkHover=setInterval(function(){g.$container.find(g.settings.children).not(".ls-ignore").each(function(){var d=a(this);g.currentMouseX>d.offset().left&&g.currentMouseX<d.offset().left+d.width()&&g.currentMouseY>d.offset().top&&g.currentMouseY<d.offset().top+d.height()&&(d.index()>=g.$placeholder.index()?g.$placeholder.insertAfter(d):g.$placeholder.insertBefore(d))})},
200)}this.$selectedChild.css({left:this.currentMouseX-this.initialMouseX+this.panelInitialX,top:this.currentMouseY-this.initialMouseY+this.panelInitialY})}},_onDragEnd:function(){this.isDragging&&(this.isDragging=!1,a("body").css("user-select",""),this.$selectedChild.css({position:"",left:"",top:"",width:"",height:"","pointer-events":""}).removeClass("ls-ignore").insertAfter(this.$placeholder),this.$placeholder.remove(),clearInterval(this.checkHover),this.endPosition=this.$selectedChild.index(),this.trigger({type:"sortEnd"}),
a.isFunction(this.settings.sortEnd)&&this.settings.sortEnd.call(this,{type:"sortEnd",startPosition:this.startPosition,endPosition:this.endPosition}));this.$selectedChild=null},destroy:function(){this.$container.removeData("lightSortable");this.isDragging&&this._onDragEnd();this.$container.off("mousedown.lightSortable."+this.uid);a(document).off("mousemove.lightSortable."+this.uid);a(document).off("mouseup.lightSortable."+this.uid)},on:function(a,g){return this.events.on(a,g)},off:function(a){return this.events.off(a)},
trigger:function(a){return this.events.triggerHandler(a)},defaults:{placeholder:"",sortStart:function(){},sortEnd:function(){}}};a.fn.lightSortable=function(d){var g=Array.prototype.slice.call(arguments,1);return this.each(function(){if("undefined"===typeof a(this).data("lightSortable")){var h=new l(this,d);a(this).data("lightSortable",h)}else"undefined"!==typeof d&&(h=a(this).data("lightSortable"),"function"===typeof h[d]?h[d].apply(h,g):a.error(d+" does not exist in lightSortable."))})}})(jQuery);
(function(a){a.lightURLParse=function(l){l=l.split("?")[1].split("&");var d=[];a.each(l,function(a,h){var c=h.split("=");d[c[0]]=c[1]});return d}})(jQuery);